# Bluetti Monitor Configuration

# ESP32 Webcam Settings
WEBCAM_URL=http://YOUR_ESP32_IP
WEBCAM_CAPTURE_ENDPOINT=/capture

# Monitoring Settings  
CAPTURE_INTERVAL=30
IMAGE_RETENTION_HOURS=24
OCR_CONFIDENCE_THRESHOLD=0.8

# API Settings
API_HOST=bluetti-monitor-api  # Docker service name for worker-to-API communication
API_PORT=8000
API_TITLE="Bluetti Monitor API"

# Logging
LOG_LEVEL=INFO
LOG_FILE=bluetti-monitor.log

# Optional: Database (if implementing persistence)
# DATABASE_URL=sqlite:///bluetti_data.db

# Optional: Metrics/Monitoring
# PROMETHEUS_ENABLED=true
# PROMETHEUS_PORT=9090

# OCR Settings
GEMINI_API_KEY=your_gemini_api_key_here

# Image Transformation Settings
IMAGE_FLIP_HORIZONTAL=true  # Flip image horizontally before OCR
IMAGE_ROTATE_180=false      # Rotate image 180 degrees before OCR

# GROQ Settings (fallback OCR provider)
GROQ_API_KEY=your_groq_api_key_here
PREFER_GROQ_OCR=false

# SwitchBot Settings (for automatic screen control)
SWITCH_BOT_TOKEN=your_switchbot_token
SWITCH_BOT_SECRET=your_switchbot_secret
SWITCH_BOT_DEVICE_NAME=  # Optional: specify device name/ID if you have multiple SwitchBots
SWITCHBOT_MAX_FAILURE_HOURS=0.25  # Container restarts after 15 minutes of SwitchBot failures

# Adaptive Tap Interval Settings (based on device states + daylight)
# Active mode: When input OR output_2 ON, OR during daylight hours (7 AM - 7 PM)
# Idle mode: When both devices OFF AND nighttime
ACTIVE_TAP_INTERVAL=300      # 5 minutes - for active monitoring
IDLE_TAP_INTERVAL=1800       # 30 minutes - for idle monitoring

# Daylight Hours Configuration (24-hour format, for solar activity detection)
DAYLIGHT_START_HOUR=7        # Daylight starts at 7 AM
DAYLIGHT_END_HOUR=19         # Daylight ends at 7 PM (19:00)

# Device Control API (for managing power outlets)
DEVICE_CONTROL_HOST=10.0.0.109
DEVICE_CONTROL_PORT=8084

# Output Control Hysteresis Settings
# Prevents oscillation by using two thresholds instead of one
# Output turns ON when battery rises ABOVE the high threshold
# Output turns OFF when battery falls BELOW the low threshold
# Between thresholds, the current output state is maintained
OUTPUT_HIGH_THRESHOLD=80    # Output turns ON above this percentage
OUTPUT_LOW_THRESHOLD=60     # Output turns OFF below this percentage

# Template Classifier Settings
MAX_IMAGES_PER_CATEGORY=10        # Maximum images per percentage category (FIFO rotation)
COMPARISON_MODE_THRESHOLD=0.25    # Threshold for comparison mode (0.25 = 25% coverage)
TEMPLATE_PREPROCESSING=histogram_eq  # Image preprocessing: "histogram_eq" (default) or "none"

# Strategy Control Settings
ENABLE_GEMINI_STRATEGY=true       # Enable Gemini/Groq LLM OCR
ENABLE_TEMPLATE_STRATEGY=true     # Enable template matching classifier
PRIMARY_STRATEGY=llm              # Primary strategy for logic: "llm" or "template"

# Comparison Storage Settings
MAX_COMPARISON_RECORDS=1000       # FIFO limit for comparison statistics

# Development Settings
DEBUG=false
DEVELOPMENT_MODE=false